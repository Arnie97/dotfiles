#!/usr/bin/env python

import os
import time
import platform

assert platform.system() == 'Windows'

path_from = 'N:\\*'
path_to   = 'T:\\Snowball\\'
path_prev = os.listdir(path_to)[-1]
path_new  = time.strftime('%Y.%m.%d-%H')
path_apps = 'N:\\Applets\\'
operation = os.system

assert path_prev != path_new

list(map(lambda x: operation(
    path_apps + x
    .replace('\n', ' ')
    .replace('    ', '')
    .strip()
), ((
    r'Schinagl\ln'
    '64' if platform.machine() == 'AMD64' else '32'
) + ' -r ' + ' '.join(map(path_to.__add__, (
    path_prev,
    path_new
))), (
    r'FastCopy\FastCopy' '''

    /to="%s"
    /no_exec
    /cmd=sync
    /linkdest
    /reparse
    /filelog
    /open_window
    /speed=full
    /estimate

''' + path_from) % (path_to + path_new))))
